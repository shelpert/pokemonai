# Notes for implementation
# use `collections.defaultdict` for the state dict.
# `typing.NamedTuple` can encode names for each thing in the state without significant overhead.
# it might be worth doing the same for the output space (lists inside tuples are still mutable)?
